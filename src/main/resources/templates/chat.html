<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Real-Time Chat Application</title>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.1/stomp.min.js"></script>
</head>
<body>

<div class="container my-4" style="height: 80vh;">
	<h1 class="text-center">Real-Time Chat Application</h1>
	
	
	<div id="chat" class="border rounded p-3 mb-3" style=" height:60vh; overflow-y:auto"></div>
	
	
	<div class="input-group mb-3">
		<input id="senderInput" type= "text" class="form-control" placeholder="Your Name ...."/>
	
	</div>
		<div class="input-group mb-3">
		<input id="messageInput" type= "text" class="form-control" placeholder="Type Message ...."/>
		<div id="input-group-append">
			<button id="sendMessage"class="btn btn-primary">SEND</button>
		</div>
	
	</div>
</div>	




<script type="text/javascript">

  	function setConnected(connected){
  		document.getElementById('sendMessage').disabled = !connected;
  	}
	function connect(){
		var socket = new SockJS('/chat');
		stompClient = Stomp.over(socket);
		stompClient.connect({}, function(frame){
			setConnected(true);
			stompClient.subscribe('/topic/messages',(message)=>{
				showMessage(JSON.parse(message.body))
			});
			
		});
	}
		
		function showMessage(message){
			var chat = document.getElementById('chat');
			var messageElement = document.createElement('div');
			messageElement.textContent = message.sender +' : '+message.content;
			messageElement.className = "border-bottom mb-1";
			chat.appendChild(messageElement);
			chat.scrollTop = chat.scrollHeight;
			
		}
		function sendMessage(){
			var sender = document.getElementById('senderInput').value;
			var content = document.getElementById('messageInput').value;
			var chatMessage = {
					sender:sender,
					content:content
			}
			stompClient.send("app/sendmessage", {}, JSON.stringify(chatMessage));
			document.getElementById('messageInput').value = '';
		}
		document.getElementById('sendMessage').onclick = sendMessage;
		window.onload = connect

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>